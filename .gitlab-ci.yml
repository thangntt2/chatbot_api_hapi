image: node:boron

stages:
  - prepare_dependencies
  - migrate
  - run

install_dependencies:
  stage: prepare_dependencies
  script:
    - npm install

migrate:
  stage: migrate
  script:
    - export MYSQL_HOST="localhost"
    - export MYSQL_PORT="3306"
    - export MYSQL_USER="root"
    - export MYSQL_PASSWORD="nhuthienthu1"
    - export MYSQL_DATABASE="vizbot"
    - npm run migrate:latest

run:
  stage: run
  script:
    - npm run start
